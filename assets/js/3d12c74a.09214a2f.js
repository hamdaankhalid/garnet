"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8708],{5088:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var t=s(4848),i=s(8453);const a={id:"garnet-specific-commands",sidebar_label:"Garnet-specific Commands",title:"Garnet-specific Commands",slug:"garnet-specific-commands"},r=void 0,l={id:"commands/garnet-specific-commands",title:"Garnet-specific Commands",description:"Apart from Garnet's server extensions, we support many API calls that are not available",source:"@site/docs/commands/garnet-specific.md",sourceDirName:"commands",slug:"/commands/garnet-specific-commands",permalink:"/garnet/docs/commands/garnet-specific-commands",draft:!1,unlisted:!1,editUrl:"https://github.com/microsoft/garnet/tree/main/website/docs/commands/garnet-specific.md",tags:[],version:"current",frontMatter:{id:"garnet-specific-commands",sidebar_label:"Garnet-specific Commands",title:"Garnet-specific Commands",slug:"garnet-specific-commands"},sidebar:"garnetDocSidebar",previous:{title:"Scripting and functions",permalink:"/garnet/docs/commands/scripting"},next:{title:"Overview",permalink:"/garnet/docs/extensions/overview"}},o={},c=[{value:"FORCEGC",id:"forcegc",level:3},{value:"Syntax",id:"syntax",level:4},{value:"Resp Reply",id:"resp-reply",level:4},{value:"COMMITAOF",id:"commitaof",level:3},{value:"Syntax",id:"syntax-1",level:4},{value:"Resp Reply",id:"resp-reply-1",level:4},{value:"COSCAN",id:"coscan",level:3},{value:"Syntax",id:"syntax-2",level:4},{value:"SECONDARYOF",id:"secondaryof",level:3},{value:"REGISTERCS",id:"registercs",level:3},{value:"RUNTXP",id:"runtxp",level:3},{value:"Syntax",id:"syntax-3",level:4},{value:"WATCHMS",id:"watchms",level:3},{value:"Syntax",id:"syntax-4",level:4},{value:"WATCHOS",id:"watchos",level:3},{value:"Syntax",id:"syntax-5",level:4},{value:"ASYNC",id:"async",level:3},{value:"MODULE LOADCS",id:"module-loadcs",level:3},{value:"Native ETag Support",id:"native-etag-support",level:2},{value:"<strong>GETWITHETAG</strong>",id:"getwithetag",level:3},{value:"<strong>Syntax</strong>",id:"syntax-6",level:4},{value:"<strong>Response</strong>",id:"response",level:4},{value:"<strong>SETIFMATCH</strong>",id:"setifmatch",level:3},{value:"<strong>Syntax</strong>",id:"syntax-7",level:4},{value:"<strong>Response</strong>",id:"response-1",level:4},{value:"<strong>GETIFNOTMATCH</strong>",id:"getifnotmatch",level:3},{value:"<strong>Syntax</strong>",id:"syntax-8",level:4},{value:"<strong>Response</strong>",id:"response-2",level:4},{value:"Compatibility and Behavior with Non-ETag Commands",id:"compatibility-and-behavior-with-non-etag-commands",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Apart from Garnet's ",(0,t.jsx)(n.a,{href:"/garnet/docs/extensions/overview",children:"server extensions"}),", we support many API calls that are not available\nin other RESP servers. These are described below."]}),"\n",(0,t.jsx)(n.h3,{id:"forcegc",children:"FORCEGC"}),"\n",(0,t.jsx)(n.h4,{id:"syntax",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"    FORCEGC [generation]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Invoke garbage collection on the server side. Optionally, specify the generation level for the collection. For more\ninformation, see ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/api/system.gc.collect",children:"this article"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"resp-reply",children:"Resp Reply"}),"\n",(0,t.jsx)(n.p,{children:"Simple string reply: OK."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"commitaof",children:"COMMITAOF"}),"\n",(0,t.jsx)(n.h4,{id:"syntax-1",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"    COMMITAOF\n"})}),"\n",(0,t.jsx)(n.p,{children:"Issues a manual commit of the append-only-file. This is useful when auto-commits are turned off, but you need the\nsystem to commit at specific times."}),"\n",(0,t.jsx)(n.h4,{id:"resp-reply-1",children:"Resp Reply"}),"\n",(0,t.jsx)(n.p,{children:"Simple string reply: OK."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"coscan",children:"COSCAN"}),"\n",(0,t.jsx)(n.h4,{id:"syntax-2",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"    COSCAN key cursor [MATCH pattern] [COUNT count] [NOVALUES]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Custom Object Scan is similar to ",(0,t.jsx)(n.a,{href:"/garnet/docs/commands/data-structures#hscan",children:"HSCAN"})," and ",(0,t.jsx)(n.a,{href:"/garnet/docs/commands/data-structures#sscan",children:"SSCAN"}),". It iterates\nover the fields and values of a custom object stored at a given key."]}),"\n",(0,t.jsx)(n.p,{children:"The match parameter allows to apply a filter to elements after they have been retrieved from the collection.\nThe count option sets a limit to the maximum number of items returned from the server to this command. This limit\nis also set in conjunction with the object-scan-count-limit of the global server settings."}),"\n",(0,t.jsx)(n.p,{children:"You can use the NOVALUES option to make Garnet return only the keys without their corresponding values."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"secondaryof",children:"SECONDARYOF"}),"\n",(0,t.jsxs)(n.p,{children:["Configures a server as secondary of another, or promotes it to a primary. Same as ",(0,t.jsx)(n.a,{href:"/garnet/docs/commands/server#replicaof",children:"REPLICAOF"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"registercs",children:"REGISTERCS"}),"\n",(0,t.jsx)(n.p,{children:"This allows registering specific custom commands and transactions implemented in C#, in a server side DLL library."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"runtxp",children:"RUNTXP"}),"\n",(0,t.jsx)(n.h4,{id:"syntax-3",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"    RUNTXP txid [args]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Runs the specific custom transactional procedure indetified by its ID."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"watchms",children:"WATCHMS"}),"\n",(0,t.jsx)(n.h4,{id:"syntax-4",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"    WATCHMS key [key ...]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Same as ",(0,t.jsx)(n.a,{href:"/garnet/docs/commands/transactions#watch",children:"WATCH"}),", but specifies that the key is only present in the main (raw string) store."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"watchos",children:"WATCHOS"}),"\n",(0,t.jsx)(n.h4,{id:"syntax-5",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"    WATCHOS key [key ...]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Same as ",(0,t.jsx)(n.a,{href:"/garnet/docs/commands/transactions#watch",children:"WATCH"}),", but specifies that the key is only present in the object store."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"async",children:"ASYNC"}),"\n",(0,t.jsxs)(n.p,{children:["Async interface to Garnet when accessing larger-than-memory data. See ",(0,t.jsx)(n.a,{href:"https://github.com/microsoft/garnet/pull/387",children:"this link"})," for details."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"module-loadcs",children:"MODULE LOADCS"}),"\n",(0,t.jsxs)(n.p,{children:["This the equivalent of ",(0,t.jsx)(n.code,{children:"MODULE LOAD"})," in the original RESP protocol. This loads a self-contained module in which the module\ninitialization code registers all relevant commands and transactions automatically. See ",(0,t.jsx)(n.a,{href:"/garnet/docs/dev/custom-commands",children:"this page"}),"\nfor details."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"native-etag-support",children:"Native ETag Support"}),"\n",(0,t.jsxs)(n.p,{children:["Garnet provides support for ETags on raw strings. By using the ETag-related commands outlined below, you can associate any ",(0,t.jsx)(n.strong,{children:"string based key-value pair"})," inserted into Garnet with an automatically updated ETag."]}),"\n",(0,t.jsx)(n.p,{children:"Compatibility with non-ETag commands and the behavior of data inserted with ETags are detailed at the end of this document."}),"\n",(0,t.jsxs)(n.p,{children:['To initialize a key value pair with an ETag you can use either the SET command with the newly added "WITHETAG" optional flag, or you can take any existing Key value pair and call SETIFMATCH with the ETag argument as 0 (Any key value pair without an explicit ETag has an ETag of 0 implicitly). You can read more about setting an initial ETag via SET ',(0,t.jsx)(n.a,{href:"../commands/raw-string#set",children:"here"})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"getwithetag",children:(0,t.jsx)(n.strong,{children:"GETWITHETAG"})}),"\n",(0,t.jsx)(n.h4,{id:"syntax-6",children:(0,t.jsx)(n.strong,{children:"Syntax"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"GETWITHETAG key\n"})}),"\n",(0,t.jsx)(n.p,{children:"Retrieves the value and the ETag associated with the given key."}),"\n",(0,t.jsx)(n.h4,{id:"response",children:(0,t.jsx)(n.strong,{children:"Response"})}),"\n",(0,t.jsx)(n.p,{children:"One of the following:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Array reply"}),": An array of two items returned on success. The first item is an integer representing the ETag, and the second is the bulk string value of the key. If called on a key-value pair without ETag, the etag will be 0."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nil reply"}),": If the key does not exist."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"setifmatch",children:(0,t.jsx)(n.strong,{children:"SETIFMATCH"})}),"\n",(0,t.jsx)(n.h4,{id:"syntax-7",children:(0,t.jsx)(n.strong,{children:"Syntax"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"SETIFMATCH key value etag [EX seconds | PX milliseconds]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Updates the value of a key if the provided ETag matches the current ETag of the key."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Options:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"EX seconds -- Set the specified expire time, in seconds (a positive integer)."}),"\n",(0,t.jsx)(n.li,{children:"PX milliseconds -- Set the specified expire time, in milliseconds (a positive integer)."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"response-1",children:(0,t.jsx)(n.strong,{children:"Response"})}),"\n",(0,t.jsx)(n.p,{children:"One of the following:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Array reply"}),": If etags match an array where the first item is the updated etag, and the second value is nil. If the etags do not match the array will hold the latest etag, and the latest value in order."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nil reply"}),": If the key does not exist."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"getifnotmatch",children:(0,t.jsx)(n.strong,{children:"GETIFNOTMATCH"})}),"\n",(0,t.jsx)(n.h4,{id:"syntax-8",children:(0,t.jsx)(n.strong,{children:"Syntax"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"GETIFNOTMATCH key etag\n"})}),"\n",(0,t.jsx)(n.p,{children:"Retrieves the value if the ETag associated with the key has changed; otherwise, returns a response indicating no change."}),"\n",(0,t.jsx)(n.h4,{id:"response-2",children:(0,t.jsx)(n.strong,{children:"Response"})}),"\n",(0,t.jsx)(n.p,{children:"One of the following:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Array reply"}),": If the ETag does not match, an array of two items is returned. The first item is the latest ETag, and the second item is the value associated with the key. If the Etag matches  the first item in the response array is the etag and the second item is nil."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nil reply"}),": If the key does not exist."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"compatibility-and-behavior-with-non-etag-commands",children:"Compatibility and Behavior with Non-ETag Commands"}),"\n",(0,t.jsx)(n.p,{children:"ETags are currently not supported for servers running in Cluster mode. This will be supported soon."}),"\n",(0,t.jsx)(n.p,{children:"Below is the expected behavior of ETag-associated key-value pairs when non-ETag commands are used."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"MSET, BITOP"}),": These commands will replace an existing ETag-associated key-value pair with a non-ETag key-value pair, effectively removing the ETag."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"SET"}),': Only if used with additional option "WITHETAG" will calling SET update the etag while inserting the new key-value pair over the existing key-value pair.']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"RENAME"}),": RENAME takes an option for WITHETAG. When called WITHETAG it will rename the key with an etag if the key being renamed to did not exist, else it will increment the existing etag of the key being renamed to."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Custom Commands"}),": While etag based key value pairs ",(0,t.jsx)(n.strong,{children:"can be used blindly inside of custom transactions and custom procedures"}),", ETag set key value pairs are ",(0,t.jsx)(n.strong,{children:"not supported to be used from inside of Custom Raw String Functions."})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"All other commands will update the etag internally if they modify the underlying data, and any responses from them will not expose the etag to the client. To the users the etag and it's updates remain hidden in non-etag commands."}),"\n",(0,t.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var t=s(6540);const i={},a=t.createContext(i);function r(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);